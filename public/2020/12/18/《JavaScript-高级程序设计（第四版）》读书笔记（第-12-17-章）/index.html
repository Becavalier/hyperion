<!DOCTYPE html><html lang="en-us"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>《JavaScript 高级程序设计（第四版）》读书笔记（第 12-17 章） | 曜彤.手记</title><meta name="description" content="书接上回，本文为第 12-17 章的笔记。"><meta name="generator" content="曜彤.手记"><meta name="about" content="[object Object]"><meta name="keywords" content="博客, C++, C, Rust, Web, Java, IT, 编程, 开发, Android, Python, MySQL, 科技, 黑客, 技术, Javascript, 云, 大数据, 计算, 机器学习, AI, 人工智能, 创业, 产品, 公司, WebAssembly, Wasm"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1,user-scalable=0"><link rel="stylesheet" type="text/css" href="/styles/screen.css"><link rel="apple-touch-icon" sizes="57x57" href="/images/apple-touch-icon-57x57.jpg"><link rel="apple-touch-icon" sizes="60x60" href="/images/apple-touch-icon-60x60.jpg"><link rel="apple-touch-icon" sizes="72x72" href="/images/apple-touch-icon-72x72.jpg"><link rel="apple-touch-icon" sizes="76x76" href="/images/apple-touch-icon-76x76.jpg"><link rel="apple-touch-icon" sizes="114x114" href="/images/apple-touch-icon-114x114.jpg"><link rel="apple-touch-icon" sizes="120x120" href="/images/apple-touch-icon-120x120.jpg"><link rel="apple-touch-icon" sizes="144x144" href="/images/apple-touch-icon-144x144.jpg"><link rel="apple-touch-icon" sizes="152x152" href="/images/apple-touch-icon-152x152.jpg"><link rel="apple-touch-icon" sizes="196x196" href="/images/apple-touch-icon-196x196.jpg"><link rel="apple-touch-icon" sizes="310x310" href="/images/apple-touch-icon-310x310.jpg"><link href="/images/splash/iphone5_splash.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image"><link href="/images/splash/iphone6_splash.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image"><link href="/images/splash/iphoneplus_splash.png" media="(device-width: 621px) and (device-height: 1104px) and (-webkit-device-pixel-ratio: 3)" rel="apple-touch-startup-image"><link href="/images/splash/iphonex_splash.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3)" rel="apple-touch-startup-image"><link href="/images/splash/iphonexr_splash.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image"><link href="/images/splash/iphonexsmax_splash.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3)" rel="apple-touch-startup-image"><link href="/images/splash/ipad_splash.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image"><link href="/images/splash/ipadpro1_splash.png" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image"><link href="/images/splash/ipadpro3_splash.png" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image"><link href="/images/splash/ipadpro2_splash.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96x96.png"><link rel="icon" type="image/png" sizes="128x128" href="/images/favicon-128.png"><link rel="icon" type="image/png" sizes="196x196" href="/images/favicon-196x196.png"><meta name="msapplication-TileColor" content="#FFFFFF"><meta name="msapplication-TileImage" content="mstile-144x144.png"><meta name="msapplication-square70x70logo" content="mstile-70x70.png"><meta name="msapplication-square150x150logo" content="mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="mstile-310x150.png"><meta name="msapplication-square310x310logo" content="mstile-310x310.png"><meta name="msapplication-square310x310logo" content="mstile-310x310.png"><link rel="manifest" href="/manifest.webmanifest"><link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="/atom.xml"><link rel="stylesheet" href="/css/prism-okaidia.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body itemscope itemtype="https://schema.org/WebPage"><div class="canvas-containter"><span>X</span></div><header itemscope itemtype="https://schema.org/WPHeader"><div class="logo"></div><h1 class="title"><a href="/" alt="曜彤.手记" title="曜彤.手记" itemprop="headline">曜彤.手记</a><a title="Atom 0.3" target="__blank" href="/atom.xml" class="rss"><img src="/images/rss.png"></a></h1><p itemprop="description" class="description">随记，关于互联网技术、产品与创业</p><nav itemscope itemtype="https://schema.org/SiteNavigationElement"><ul><li itemprop="name" class="menu-item"><a href="/ " alt="首页" title="首页" itemprop="url">首页</a></li><li itemprop="name" class="menu-item"><a href="/articles" alt="文章" title="文章" itemprop="url">文章</a></li><li itemprop="name" class="menu-item"><a href="/tags" alt="标签" title="标签" itemprop="url">标签</a></li><li itemprop="name" class="menu-item"><a href="/about" alt="关于" title="关于" itemprop="url">关于</a></li></ul></nav><p class="meta-icp"><a target="_blank" href="https://beian.miit.gov.cn/"><span>吉 ICP 备 10004938-2 号</span></a></p><div class="space"></div></header><main itemscope itemtype="https://schema.org/Blog"><script src="https://shadow.elemecdn.com/npm/zoomage.js@latest/dist/zoomage.min.js" type="text/javascript"></script><script src="https://shadow.elemecdn.com/npm/axios@0.18.0/dist/axios.min.js" type="text/javascript"></script><script src="/scripts/post.js" type="text/javascript"></script><div class="touch-top"><span></span></div><article post-id="《JavaScript 高级程序设计（第四版）》读书笔记（第 12-17 章）" class="full"><h1 itemprop="headline" class="align-center">《JavaScript 高级程序设计（第四版）》读书笔记（第 12-17 章）</h1><div class="content"><div class="article-meta"><span class="post-meta"><br>Created on<time itemprop="dateCreated" datetime="2020-12-18T15:24:24.000Z"> 2020 / 12 / 18, 23:24:24</time></span><span class="page-tag-anchor"><a href="/tags/JavaScript" itemprop="url">#JavaScript</a>&nbsp;&nbsp;</span></div><p>书接上回，本文为第 12-17 章的笔记。</p>
<h3 id="第-12-章-BOM"><a href="#第-12-章-BOM" class="headerlink" title="第 12 章 - BOM"></a>第 12 章 - BOM</h3><ol start="50">
<li><span class="pn">Page 873</span><code>window</code> 对象：</li>
</ol>
<ul>
<li><em><strong>top / self / parent</strong></em>：分别指向“最上层”、“自身”以及“父层”窗口；</li>
<li><em><strong>screenLeft / screenTop</strong></em>：表示窗口相对<strong>屏幕</strong>左侧、顶部的位置；</li>
<li>（方法）<em><strong>moveTo / moveBy</strong></em>：移动窗口（可能被禁用）；</li>
<li>（方法）<em><strong>resizeTo / resizeBy</strong></em>：缩放窗口（可能被禁用）；</li>
<li>（方法）<em><strong>scrollTo / scrollBy</strong></em>：滚动窗口；</li>
</ul>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// scroll document to a fixed position (1000, 0).</span>
window<span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  left<span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">,</span> 
  top<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> 
  behavior<span class="token punctuation">:</span> <span class="token string">'smooth'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><em><strong>devicePixelRatio</strong></em>：表示物理像素与逻辑像素（CSS 像素）之间的缩放系数；</li>
<li><em><strong>outerWidth / outerHeight</strong></em>：返回浏览器<strong>窗口自身</strong>的大小；</li>
<li><em><strong>innerWidth / innerHeight</strong></em>：返回浏览器<strong>窗口中页面视口</strong>的大小（不包含浏览器边框和工具链）；</li>
</ul>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// get the size of the viewport.</span>
<span class="token keyword">let</span> <span class="token punctuation">{</span> innerWidth<span class="token punctuation">,</span> innerHeight <span class="token punctuation">}</span> <span class="token operator">=</span> window<span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> innerWidth <span class="token operator">!==</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>compatMode <span class="token operator">===</span> <span class="token string">'CSS1Compat'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    innerWidth <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientWidth<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// &lt;html>.</span>
    innerHeight <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientHeight<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    innerWidth <span class="token operator">=</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>clientWidth<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// &lt;body>.</span>
    innerHeight <span class="token operator">=</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>clientHeight<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><em><strong>pageXOffset / pageYOffset</strong></em>：获得文档相对于当前视口的滚动距离（X/Y）；</li>
<li>（方法）<em><strong>open</strong></em>：导航到指定 URL 或打开新浏览器窗口；</li>
<li>（方法）<em><strong>close</strong></em>：关闭当前窗口；</li>
<li><em><strong>closed</strong></em>：判断所引用窗口是否已关闭（<strong>常用于 window.open() 的返回窗口</strong>）；</li>
<li><em><strong>opener</strong></em>：仅存在于新创建窗口返回的 window 对象上，<strong>指向打开它的窗口</strong>。将该属性设置为 null 表示新打开的标签页不需要与打开它的标签页通信，因此可以在独立进程中运行；</li>
<li>（方法）<em><strong>setTimeout / setInterval</strong></em>：函数第二个参数指定的时间为<strong>向异步队列添加新任务之前等待的时间</strong>（同步任务会优先执行）。被添加到队列中的任务会按照顺序执行；</li>
<li>（方法）<em><strong>alert / confirm / prompt</strong></em>：系统对话框；</li>
</ul>
<ol start="51">
<li><span class="pn">Page 895</span><code>window.location</code> 对象：</li>
</ol>
<ul>
<li><code>window.location</code> 与 <code>document.location</code> <strong>指向同一个对象</strong>；</li>
<li>除 hash 属性外，<strong>只要修改 location 的一个属性，就会导致页面重新加载新的 URL</strong>。</li>
</ul>
<p>- <em><strong>属性和方法</strong></em>：</p>
<ul>
<li><em><strong>hash</strong></em>：URL 散列值；</li>
<li><em><strong>host</strong></em>：服务器名及端口号；</li>
<li><em><strong>hostname</strong></em>：服务器名；</li>
<li><em><strong>href</strong></em>：当前页面完整 URL（同 *location.toString()*）。修改该值或 <em>window.location</em>，可以导航到特定的 URL；</li>
<li>（方法）<em><strong>assign</strong></em>：导航到特定 URL；</li>
<li>（方法）<em><strong>replace</strong></em>：导航到特定 URL（但不增加新历史记录，仅替换）；</li>
<li>（方法）<em><strong>reload</strong></em>：重新加载当前页面。传递参数为 true 时会从服务器请求而不使用缓存；</li>
<li><em><strong>pathname</strong></em>：URL 中的路径/文件名；</li>
<li><em><strong>port</strong></em>：端口号；</li>
<li><em><strong>protocol</strong></em>：页面使用的协议；</li>
<li><em><strong>search</strong></em>：URL 的<strong>查询字符串</strong>（queries）；<ul>
<li>可以使用 <strong>URLSearchParams</strong> 接口来方便地检查和修改查询字符串；</li>
</ul>
</li>
<li><em><strong>username</strong></em>：域名前指定的用户名；</li>
<li><em><strong>password</strong></em>：域名前指定的密码；</li>
<li><em><strong>origin</strong></em>：URL 的源地址。</li>
</ul>
<ol start="52">
<li><span class="pn">Page 904</span><code>window.navigator</code> 对象：</li>
</ol>
<ul>
<li>用于<strong>标识浏览器</strong>（描述了浏览器状态和标识）。</li>
</ul>
<p>- <em><strong>属性和方法</strong></em>：</p>
<ul>
<li><em><strong>plugins</strong></em>：包含浏览器所安装插件的信息；</li>
<li><em><strong>userAgent</strong></em>：获得用户代理信息；</li>
<li>（方法）<em><strong>registerProtocolHandler</strong></em>：可以将某个网站注册为处理某种特定类型信息的应用程序；</li>
</ul>
<ol start="53">
<li><span class="pn">Page 914</span><code>window.screen</code> 对象：保存着<strong>客户端显示器信息</strong>。</li>
<li><span class="pn">Page 916</span><code>window.history</code> 对象：</li>
</ol>
<ul>
<li>保存有当前窗口首次使用以来<strong>用户的导航历史记录</strong>。</li>
</ul>
<p>- <em><strong>属性和方法</strong></em>：</p>
<ul>
<li>（方法）<em><strong>go / back / forward</strong></em>：可以在用户历史记录中进行导航；</li>
<li><em><strong>length</strong></em>：返回当前历史记录中的条目数量；</li>
<li>（方法）<em><strong>pushState</strong></em>：向当前浏览器会话的历史堆栈中<strong>添加一个状态，但不向服务器发送请求，同时触发 <code>popstate</code> 事件</strong>（浏览器地址栏会反映出新的状态）；</li>
</ul>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">let</span> stateObj <span class="token operator">=</span> <span class="token punctuation">{</span> foo<span class="token punctuation">:</span> <span class="token string">'bar'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">pushState</span><span class="token punctuation">(</span>stateObj<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">'baz.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<ul>
<li>（方法）<em><strong>replaceState</strong></em>：（同上）但不会创建新历史纪录，只会覆盖当前状态；</li>
<li><em><strong>state</strong></em>：获取当前页面状态；</li>
</ul>
<h3 id="第-13-章-客户端检测"><a href="#第-13-章-客户端检测" class="headerlink" title="第 13 章 - 客户端检测"></a>第 13 章 - 客户端检测</h3><p>（略）</p>
<h3 id="第-14-章-DOM"><a href="#第-14-章-DOM" class="headerlink" title="第 14 章 - DOM"></a>第 14 章 - DOM</h3><ol start="55">
<li><span class="pn">Page 970</span>DOM：<strong>HTML 与 XML 文档的编程接口</strong>。DOM 表示由多层节点构成的文档，通过它开发者可以添加、删除和修改页面的各个部分。</li>
</ol>
<ul>
<li><em><strong>DOM Level 1</strong></em>：1998 年成为 W3C 推荐标准，提供了基本文档结构和查询接口；</li>
<li>在 JavaScript 中，<strong>所有节点类型都继承 Node 类型</strong>；<ul>
<li>HTMLElement（<strong>所有 HTML 元素均为该类型或其子类型的实例</strong>） -&gt; ELement -&gt; Node；</li>
<li>HTMLDocument（document）-&gt; Document -&gt; Node；</li>
<li>Text -&gt; CharacterData -&gt; Node；</li>
<li>Comment -&gt; CharacterData -&gt; Node；</li>
</ul>
</li>
<li><code>document</code> 对象中的获取元素方法会返回 <strong>HTMLCollection</strong> 类型，该类型仅能包含有 ELement 类型的节点；</li>
<li><strong>12 种节点类型</strong>（浏览器并不支持所有节点类型）：<ol>
<li><em><strong>Node.ELEMENT_NODE</strong></em>：元素节点；</li>
<li><em><strong>Node.ATTRIBUTE_NODE</strong></em>：属性节点；</li>
<li><em><strong>Node.TEXT_NODE</strong></em>：文本节点；</li>
<li><em><strong>Node.CDATA_SECTION_NODE</strong></em>：CDATA 节点（&lt;!CDATA[[ … ]]&gt;）；</li>
<li><em><strong>Node.ENTITY_REFERENCE_NODE</strong></em>：（已在 DOM4 中移除）；</li>
<li><em><strong>Node.ENTITY_NODE</strong></em>：（已在 DOM4 中移除）；</li>
<li><em><strong>Node.PROCESSING_INSTRUCTION_NODE</strong></em>：处理指令节点（&lt;?xml-stylesheet … ?&gt;）；</li>
<li><em><strong>Node.COMMENT_NODE</strong></em>：注释节点（&lt;!– … –&gt;）；</li>
<li><em><strong>Node.DOCUMENT_NODE</strong></em>：文档节点（document）；</li>
<li><em><strong>Node.DOCUMENT_TYPE_NODE</strong></em>：文档类型节点（&lt;!DOCTYPE html&gt;）；</li>
<li><em><strong>Node.DOCUMENT_FRAGMENT_NODE</strong></em>：文档片段节点；</li>
<li><em><strong>Node.NOTATION_NODE</strong></em>：（已在 DOM4 中移除）；</li>
</ol>
</li>
<li>HTMLDocument 类型下只能有四种类型的子节点：<ul>
<li>DocumentType（<strong>最多一个</strong>）；</li>
<li>Element（<strong>最多一个</strong>，通常为 &lt;html&gt;）;</li>
<li>ProcessingInstruction；</li>
<li>Comment；</li>
</ul>
</li>
</ul>
<p>- <em><strong>document 额外属性和方法</strong></em>：</p>
<ul>
<li><em><strong>title</strong></em>：返回文档标题；</li>
<li><em><strong>URL</strong></em>：返回文档 URL；</li>
<li><em><strong>domain</strong></em>：返回文档所在域名（修改该值可用于跨越，如：<strong>设置 iframe 文档域名与当前文档域名为同一个二级域名</strong>，即去掉三级及以上域名的差异）；</li>
<li><em><strong>referrer</strong></em>：返回文档来源 URL；</li>
<li><em><strong>body</strong></em>：返回文档 &lt;body&gt; 元素；</li>
<li><em><strong>getElementById</strong></em>：通过 ID 获取文档上的元素；</li>
<li><em><strong>getElementsByTagName</strong></em>：通过元素名获取文档上的元素；</li>
<li><em><strong>getElementsByName</strong></em>：通过属性名获取文档上的元素（适用于 &lt;input type=”radio”&gt; 元素）；</li>
<li><em><strong>styleSheets</strong></em>：返回文档中可用的样式表（CSSStyleSheet）集合；</li>
<li><em><strong>anchors</strong></em>：包含文档中所有带 name 的 &lt;a&gt; 元素；</li>
<li><em><strong>forms</strong></em>：包含文档中所有的 &lt;form&gt; 元素；</li>
<li><em><strong>images</strong></em>：包含文档中所有的 &lt;img&gt; 元素；</li>
<li><em><strong>links</strong></em>：包含文档中所有带 href 的 &lt;a&gt; 元素；</li>
<li><em><strong>implementation</strong></em>：一个对象，提供了与浏览器 DOM 实现相关的信息和能力（已废弃，均返回 true）；</li>
<li>（方法）<em><strong>write / writeln</strong></em>：向网页输出流中写入内容；</li>
<li>（方法）<em><strong>open / close</strong></em>：打开/关闭网页输出流；</li>
<li>（Node.DOCUMENT_TYPE_NODE<em><strong>doctype</strong></em>：返回<strong>文档类型对象</strong>；<ul>
<li><em>name</em>：返回文档类型名称。</li>
</ul>
</li>
<li>（Node.TEXT_NODE）（方法）<em><strong>createTextNode</strong></em>：创建文本节点；</li>
<li>（Node.COMMENT_NODE）（方法）<em><strong>createComment</strong></em>：创建注释节点；</li>
<li>（Node.DOCUMENT_FRAGMENT_NODE）（方法）<em><strong>createDocumentFragment</strong></em>：创建文档片段（<strong>可用作被实际添加文档的父节点，以避免浏览器的多次渲染</strong>）；</li>
<li>（Node.ATTRIBUTE_NODE）（方法）<em><strong>createAttribute / setAttributeNode</strong></em>：创建和设置属性节点；</li>
</ul>
<p>- <em><strong>DOM 节点查询属性和方法</strong></em>：</p>
<ul>
<li>（节点操作）<em><strong>nodeName</strong></em>：返回节点的名称（一般为标签名大写）；</li>
<li>（节点操作）<em><strong>nodeValue</strong></em>：文本节点返回文本值；元素节点始终返回 null；</li>
<li>（节点操作）<em><strong>nodeType</strong></em>：返回节点的类型常量；</li>
<li><em><strong>childNodes</strong></em>：返回类数组 NodeList，存放子元素实例；<ul>
<li>（方法）<em><strong>item</strong></em>：返回该集合中某位置的元素；</li>
</ul>
</li>
<li><em><strong>parentNode</strong></em>：返回父元素实例；</li>
<li><em><strong>previousSibling</strong></em>：返回前一个同胞元素；</li>
<li><em><strong>nextSibling</strong></em>：返回下一个同胞元素；</li>
<li><em><strong>firstChild</strong></em>：返回该元素的第一个子元素；</li>
<li><em><strong>lastChild</strong></em>：返回该元素的最后一个子元素；</li>
<li>（方法）<em><strong>hasChildNodes</strong></em>：返回当前元素是否有子元素；</li>
<li><em><strong>ownerDocument</strong></em>：返回当前元素的所在文档节点；</li>
</ul>
<p>- <em><strong>DOM 节点操作属性和方法</strong></em>：</p>
<ul>
<li>（Node.ELEMENT_NODE）<em><strong>id</strong></em>：获取/设置当前元素的 ID；</li>
<li>（Node.ELEMENT_NODE）<em><strong>className</strong></em>：获取/设置当前元素的类名；</li>
<li>（Node.ELEMENT_NODE）<em><strong>title</strong></em>：获取/设置当前元素的标题；</li>
<li>（Node.ELEMENT_NODE）（方法）<em><strong>getAttribute / setAttribute / removeAttribute</strong></em>：获取/设置/移除当前元素的 <strong>HTML 属性</strong>（属性名要保持一致，获取的属性值通常以“<strong>字符串</strong>”的形式来表示）；</li>
<li>（Node.ELEMENT_NODE）<b><i>attributes / getAttributeNode()</i></b>：获取当前元素的属性集合（NamedNodeMap 对象，保存了 Attr 节点）；<ul>
<li>（方法）<em>getNamedItem</em>：返回某个<strong>属性节点</strong>；</li>
<li>（方法）<em>removeNamedItem</em>：删除某个属性节点；</li>
<li>（方法）<em>setNamedItem</em>：设置某个属性节点；</li>
<li>（方法）<em>item</em>：获得索引位置 pos 处的节点。</li>
</ul>
</li>
<li>（Node.ELEMENT_NODE）（方法）<em><strong>createElement</strong></em>：创建新元素；</li>
<li>（Node.TEXT_NODE）（方法）<em><strong>appendData</strong></em>：向文本节点末尾添加数据；</li>
<li>（Node.TEXT_NODE）（方法）<em><strong>deleteData</strong></em>：删除文本；</li>
<li>（Node.TEXT_NODE）（方法）<em><strong>insertData</strong></em>：插入文本；</li>
<li>（Node.TEXT_NODE）（方法）<em><strong>replaceData</strong></em>：替换文本；</li>
<li>（Node.TEXT_NODE）（方法）<em><strong>splitText</strong></em>：拆分文本（与 <em>normalize</em> 作用相反）；</li>
<li>（Node.TEXT_NODE）（方法）<em><strong>substringData</strong></em>：提取文本子串；</li>
<li>（Node.TEXT_NODE）<em><strong>length</strong></em>：返回文本节点长度；</li>
<li>（方法）<em><strong>appendChild</strong></em>：为当前元素添加子元素（位于末尾）；</li>
<li>（方法）<em><strong>insertBefore</strong></em>：为当前元素添加子元素（位于参考节点之前）；</li>
<li>（方法）<em><strong>replaceChild</strong></em>：替换子元素；</li>
<li>（方法）<em><strong>removeChild</strong></em>：移除子元素；</li>
<li>（方法）<em><strong>cloneNode</strong></em>：克隆当前元素（可选是否深复制）。<strong>新复制的元素会丢失原有的事件处理器</strong>；</li>
<li>（方法）<em><strong>normalize</strong></em>：检测当前节点的所有后代，<strong>删除不包含文本的文本节点，或合并互为同胞关系的文本节点</strong>；</li>
</ul>
<ol start="56">
<li><span class="pn">Page 1043</span><strong>MutationObserver</strong> 接口（取代了废弃的 MutationEvent）：可以用于监听 DOM 改动。</li>
</ol>
<ul>
<li>回调函数会接收一个 <code>MutationRecords</code>，记录所有变更的详细信息。记录<strong>按照变化事件发生的顺序被添加</strong>，核心为“异步回调与记录队列模型”；</li>
<li>MutationObserver 实例拥有对要观察目标节点的“<strong>弱引用</strong>”，而目标节点则拥有对 MutationObserver 的“<strong>强引用</strong>”。MutationRecord 可能包含有对 DOM 节点的引用，因此若保存这些实例，则可能对节点的垃圾回收产生影响。</li>
</ul>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">let</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MutationObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span>mutationRecords<span class="token punctuation">,</span> observer<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mutationRecords<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  attributeOldValue<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// 是否记录观察之前的属性值；</span>
  attributeFilter<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'class'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// 观察的属性列表；</span>
  attributes<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// 观察属性变化；</span>
  characterData<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// 修改字符数据是否触发变化事件；</span>
  characterDataOldValue<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// 是否记录之前变化的字符数据；</span>
  childList<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// 修改目标节点的子节点是否触发变化事件；</span>
  subtree<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// 观察子树；</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
observer<span class="token punctuation">.</span><span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="第-15-章-DOM-扩展"><a href="#第-15-章-DOM-扩展" class="headerlink" title="第 15 章 - DOM 扩展"></a>第 15 章 - DOM 扩展</h3><ol start="57">
<li><span class="pn">Page 1071</span>Selector API：</li>
</ol>
<ul>
<li>（方法）<em><strong>querySelector</strong></em>：返回符合条件的<strong>第一个元素</strong>；</li>
<li>（方法）<em><strong>querySelectorAll</strong></em>：返回一个包含<strong>所有匹配元素的 NodeList 静态实例</strong>；</li>
<li>（方法）<em><strong>matches</strong></em>：返回是否存在所匹配的元素。</li>
</ul>
<ol start="58">
<li><span class="pn">Page 1075</span><strong>元素遍历</strong>（Element Traversal 规范）：</li>
</ol>
<ul>
<li><em><strong>childElementCount</strong></em>：返回子元素数量（不包含文本节点和注释）；</li>
<li><em><strong>firstElementChild</strong></em>：指向第一个 <strong>Element 类型</strong>的子元素（Element 版的 <em>firstChild</em>）；</li>
<li><em><strong>lastElementChild</strong></em>：指向最后一个 <strong>Element 类型</strong>的子元素（Element 版的 <em>lastChild</em>）；</li>
<li><em><strong>previousElementSibling</strong></em>：指向前一个 <strong>Element 类型</strong>的同胞元素（Element 版的 <em>previousSibling</em>）；</li>
<li><em><strong>nextElementSibling</strong></em>：指向后一个 <strong>Element 类型</strong>的同胞元素（Element 版的 <em>nextSibling</em>）；</li>
</ul>
<ol start="59">
<li><span class="pn">Page 1077</span><strong>HTML5</strong>：</li>
</ol>
<ul>
<li>（方法）<em><strong>getElementsByClassName</strong></em>：根据类名获取元素（返回 NodeList）；</li>
<li><em><strong>dataset</strong></em>：包含当前元素上的所有<strong>自定义属性</strong>（以 “data-” 作为前缀开头）；</li>
<li><em><strong>innerHTML</strong></em>：读取/更换<strong>当前元素内部（不包含该元素）</strong>的 HTML 字符串（<strong>HTML5 下通过该属性动态插入的 &lt;script&gt; 标签是不会被执行的</strong>）；</li>
<li><em><strong>outerHTML</strong></em>：读取/更换<strong>当前元素及其内部</strong>的 HTML 字符串；</li>
<li>（方法）<em><strong>insertAdjacentHTML</strong></em>：插入 HTML 元素；</li>
<li>（方法）<em><strong>insertAdjacentText</strong></em>：插入文本（节点）；</li>
<li>（方法）<em><strong>scrollIntoView</strong></em>：<strong>滚动浏览器窗口或容器窗口以便包含元素进入视口</strong>；</li>
<li><em><strong>classList</strong></em>：包含当前元素所有类型的一个集合（DOMTokenList）；<ul>
<li>*add(value)*：向类名列表中添加类名；</li>
<li>*contains(value)*：返回给定类名是否存在；</li>
<li>*remove(value)*：删除指定类名；</li>
<li>*toggle(value)*：若指定类名存在，则删除；否则添加。</li>
</ul>
</li>
<li>（HTMLDocument）<em><strong>activeElement</strong></em>：返回<strong>当前拥有焦点的 DOM 元素</strong>（默认为 <em>document.body</em>）；</li>
<li>（HTMLDocument）（方法）<em><strong>hasFocus</strong></em>：返回文档当前<strong>是否拥有焦点</strong>（表明用户是否在操作页面）；</li>
<li>（HTMLDocument）<em><strong>readyState</strong></em>：表明当前文档的<strong>状态</strong>；<ul>
<li><em>loading</em>：文档正在加载；</li>
<li><em>complete</em>：文档加载完成。</li>
</ul>
</li>
<li>（HTMLDocument）<em><strong>compatMode</strong></em>：返回当前文档的渲染模式（标准模式 / 怪异模式）；</li>
<li>（HTMLDocument）<em><strong>head</strong></em>：<strong>指向 &lt;head&gt; 元素</strong>；</li>
<li>（HTMLDocument）<em><strong>characterSet</strong></em>：当前页面使用的<strong>字符集</strong>（默认为 UTF-16）；</li>
</ul>
<p>- <em><strong>专有扩展（未进入标准）</strong></em>：</p>
<ul>
<li><em><strong>children</strong></em>：返回一个 HTMLCollection，<strong>包含所有 Element 类型的子节点</strong>；</li>
<li>（方法）<em><strong>contains</strong></em>：用于验证个元素是否为另一个元素的后代；</li>
<li><em><strong>innerText</strong></em>：读取/更换<strong>当前元素内部（不包含该元素）</strong>的文本（按照 DFS 的顺序将子树中的所有文本节点值拼接起来）；</li>
<li><em><strong>outerText</strong></em>：（同上，但包含当前节点）；</li>
</ul>
<h3 id="第-16-章-DOM2-和-DOM3"><a href="#第-16-章-DOM2-和-DOM3" class="headerlink" title="第 16 章 - DOM2 和 DOM3"></a>第 16 章 - DOM2 和 DOM3</h3><ol start="60">
<li><span class="pn">Page 1106</span>DOM 子集：</li>
</ol>
<ul>
<li><em><strong>DOM Core</strong></em>：在 DOM1 核心部分基础上，为节点<strong>增加方法和属性</strong>；</li>
<li><em><strong>DOM Views</strong></em>：定义<strong>基于样式信息的不同视图</strong>；</li>
<li><em><strong>DOM Events</strong></em>：定义<strong>通过事件实现 DOM 文档交互</strong>；</li>
<li><em><strong>DOM Style</strong></em>：定义<strong>以编程方式访问和修改 CSS 样式</strong>的接口；</li>
<li><em><strong>DOM Traversal and Ranges</strong></em>：<strong>遍历 DOM 文档</strong>及<strong>选择文档内容</strong>的接口；</li>
<li><em><strong>DOM HTML</strong></em>：在 DOM1 部分基础上，<strong>增加属性、方法和新接口</strong>；</li>
<li><em><strong>DOM Mutation Observers</strong></em>：定义<strong>基于 DOM 变化触发回调</strong>的接口。</li>
</ul>
<ol start="61">
<li><span class="pn">Page 1107</span>XML 命名空间：可以实现<strong>在一个格式规范的文档中混用不同的 XML 语言</strong>。</li>
</ol>
<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/1999/xhtml<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/2000/svg<span class="token punctuation">"</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1.1<span class="token punctuation">"</span></span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 0 100 100<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      &lt;rect x="0" y ="0" width="100" height="100" style="fill:red" />
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><code>xmlns</code> 属性用于标注 XML 语言（元素）所属的命名空间；</li>
<li>DOM2 / DOM3 中，新增<strong>特定于命名空间的属性和方法</strong>：<ul>
<li><em>localname</em>：不包含命名空间前缀的节点名；</li>
<li><em>namespaceURI</em>：节点的命名空间 URL；</li>
<li><em>prefix</em>：命名空间前缀；</li>
<li>（Node）*isDefaultNamespace(namespaceURI)*：表示给定 URI 是否为节点的默认命名空间；</li>
<li>（Node）*lookupNamespaceURI(prefix)*：返回给定前缀对应的命名空间 URI；</li>
<li>（Node）*lookupPrefix(namespaceURI)*：返回给定命名空间对应的前缀；</li>
<li>（HTMLDocument）*createElementNS(namespaceURI, tagName)*：创建指定命名空间的标签元素；</li>
<li>（HTMLDocument）*createAttributeNS(namespaceURI, attributeName)*：创建指定命名空间的属性；</li>
<li>（HTMLDocument）*getElementByTagNameNS(namespaceURI, tagName)*：返回指定命名空间中所有符合标签名的元素（NodeList）。</li>
<li>…（其他不一一列举，均与“命名空间”相关）</li>
</ul>
</li>
</ul>
<ol start="62">
<li><span class="pn">Page 1119</span>DOM 节点相关属性和方法：</li>
</ol>
<ul>
<li>（方法）<em><strong>isSameNode</strong></em>：验证两个节点是否<strong>相同</strong>（同一个引用）；</li>
<li>（方法）<em><strong>isEqualNode</strong></em>：验证两个节点是否<strong>相等</strong>（节点类型相同、属性相同，子节点也相等）；</li>
<li>（HTMLIFrameElement）<em><strong>contentDocument</strong></em>：包含子内联窗格中内容的 <em><strong>document</strong></em> 对象指针（受跨域限制）；</li>
<li>（HTMLIFrameElement）<em><strong>contentWindow</strong></em>：包含子内联窗格的 <em><strong>window</strong></em> 对象指针（受跨域限制）。</li>
</ul>
<ol start="63">
<li><span class="pn">Page 1123</span><strong>样式属性</strong>：</li>
</ol>
<ul>
<li><em><strong>style</strong></em>：返回一个 CSSStyleDeclaration 实例，<strong>包含所有通过 HTML style 属性为元素设置的所有样式信息</strong>（样式名为“<strong>驼峰大小写</strong>”形式）；<ul>
<li><em>cssText</em>：包含 style 属性中的 CSS 代码；</li>
<li><em>length</em>：应用给元素的 CSS 属性数量；</li>
<li><em>parentRule</em>：表示 CSS 信息的 CSSRule 对象；</li>
<li>（已废弃）*getPropertyCSSValue(propertyName)*：获取某个 CSS 属性值；</li>
<li>*getPropertyPriority(propertyName)*：获得 CSS 属性优先级；</li>
<li>*getPropertyValue(propertyName)*：获得 CSS 属性的字符串值；</li>
<li>*item(index)*：根据索引获得 CSS 属性名；</li>
<li>*removeProperty(propertyName)*：移除 CSS 属性值；</li>
<li>*setProperty(propertyName, value, priority)*：添加 CSS 属性值；</li>
</ul>
</li>
<li>（Window）（方法）<em><strong>getComputedStyle</strong></em>：获得给定元素的<strong>计算样式</strong>，返回一个 CSSStyleDeclaration 对象；</li>
</ul>
<ol start="64">
<li><span class="pn">Page 1131</span><strong>操作样式表</strong>：</li>
</ol>
<ul>
<li><strong><code>CSSStyleSheet</code> 类型表示通用的 CSS 样式表</strong>，包括使用 &lt;link&gt; 引入（HTMLLinkElement）和 &lt;style&gt; 元素定义（HTMLStyleElement）的样式表：<ul>
<li>继承关系：CSSStyleSheet -&gt; StyleSheet；</li>
<li>该对象<strong>只读</strong>（除一个属性例外）。</li>
</ul>
</li>
<li>CSSStyleSheet 上的属性和方法（部分继承自 StyleSheet）：<ul>
<li><em>disabled</em>：表示是否禁用样式表（该属性<strong>可修改</strong>）；</li>
<li><em>href</em>：返回样式表的 URL；</li>
<li><em>media</em>：样式表支持的媒体类型集合；</li>
<li><em>ownerNode</em>：指向拥有当前样式表的节点，一般为 &lt;link&gt; 或 &lt;style&gt; 元素；</li>
<li><em>parentStyleSheet</em>：指向导入它的样式表（@import）；</li>
<li><em>title</em>：返回 ownerNode 的 title 属性；</li>
<li><em>type</em>：表示样式表的类型，即 “<strong>text/css</strong>”；</li>
<li><em>cssRules</em>：返回<strong>当前样式表包含的样式规则集合</strong>；</li>
<li><em>ownerRule</em>：指向样式表的导入规则（@import）；</li>
<li>*deleteRule(index)*：在指定位置删除 cssRules 中的规则；</li>
<li>*insertRule(rule, index)*：在指定位置向 cssRules 中插入规则。</li>
</ul>
</li>
</ul>
<ol start="65">
<li><span class="pn">Page 1137</span><strong>元素尺寸</strong>：</li>
</ol>
<p>- <em><strong>偏移尺寸属性</strong></em>：</p>
<p><img src="1.png"></p>
<ul>
<li><em><strong>offsetHeight</strong></em>：元素在垂直方向上占用的像素尺寸（包括高度、水平滚动条高度，以及上下边框高度）；</li>
<li><em><strong>offsetLeft</strong></em>：元素左边框<strong>距离包含元素</strong>（offsetParent，通常为 &lt;body&gt;）左边框内侧的像素；</li>
<li><em><strong>offsetTop</strong></em>：元素上边框<strong>距离包含元素</strong>（offsetParent，通常为 &lt;body&gt;）上边框内侧的像素；</li>
<li><em><strong>offsetWidth</strong></em>：素在水平方向上占用的像素尺寸（包括宽度、垂直滚动条宽度，以及左右边框高度）。</li>
</ul>
<p>- <em><strong>客户端尺寸属性</strong></em>：</p>
<p><img src="2.png"></p>
<ul>
<li><em><strong>clientWidth</strong></em>：内容区宽度 + 左右内边距宽度（不超过视口尺寸）；</li>
<li><em><strong>clientHeight</strong></em>：内容区高度 + 上下内边距宽度（不超过视口尺寸）。</li>
</ul>
<p>- <em><strong>滚动尺寸属性</strong></em>：</p>
<p><img src="3.png"></p>
<ul>
<li><em><strong>scrollHeight</strong></em>：元素内容总高度；</li>
<li><em><strong>scrollWidth</strong></em>：元素内容总宽度；</li>
<li><em><strong>scrollLeft</strong></em>：内容区左侧隐藏的像素数（可写）；</li>
<li><em><strong>scrollTop</strong></em>：内容区顶部隐藏的像素数（可写）。</li>
</ul>
<p>- <em><strong>确定元素尺寸</strong></em>：</p>
<p><img src="4.png"></p>
<ul>
<li>（方法）<em><strong>getBoundingClientRect</strong></em>：返回一个 DOMRect 对象，包含元素在页面中相对于视口的位置信息。</li>
</ul>
<ol start="66">
<li><span class="pn">Page 1144</span><strong>DOM 遍历</strong>：<b><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/NodeIterator">NodeIterator</a></b> \ <b><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/TreeWalker">TreeWalker</a></b>（两套 DOM API）；</li>
<li><span class="pn">Page 1156</span><strong>DOM 范围</strong>：<b><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/Range">Range</a></b>；</li>
</ol>
<h3 id="第-17-章-事件"><a href="#第-17-章-事件" class="headerlink" title="第 17 章 - 事件"></a>第 17 章 - 事件</h3><ol start="67">
<li>（Page：<a name="1176" href="#1176">1176</a>）事件捕获与事件冒泡：前者的事件由最外层向目标事件传播；后者由目标元素向最上层元素逐层传播。现代浏览器会<strong>先进行捕获（到达目标元素），再进行冒泡（从目标元素开始）</strong>；</li>
</ol>
<p><img src="5.png"></p>
<ol start="68">
<li><span class="pn">Page 1181</span><strong>事件处理程序</strong>（Event Handler）：</li>
</ol>
<ul>
<li><strong>HTML 内联</strong>：直接定义在 HTML 元素上的事件处理器会创建一个特殊的包装函数，该函数内有一个特殊的局部变量 <strong>event</strong>。在该函数中，<strong>this 的值相当于事件的目标元素</strong>；</li>
</ul>
<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
   <span class="token comment" spellcheck="true">&lt;!-- 包装函数扩展了作用域链，可以直接访问成员对象 --></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Echo Username<span class="token punctuation">"</span></span> <span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>console.log(username.value)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><strong>DOM0</strong>：诸如 <code>onclick</code> 等事件处理程序属性，默认注册在事件流的<strong>冒泡阶段</strong>。通过将改属性设置为 null，可以移除事件处理程序：</li>
</ul>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">let</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myBtn'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>btn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  btn<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><strong>DOM2</strong>：新增两个 API。<ul>
<li>（方法）<em><strong>addEventListener</strong></em>：添加事件处理程序（默认注册在事件流的<strong>冒泡阶段</strong>）；</li>
<li>（方法）<em><strong>removeEventListener</strong></em>：移除事件处理程序；</li>
</ul>
</li>
</ul>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">let</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myBtn'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> handler <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>btn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  btn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> handler<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
btn<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> handler<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="69">
<li><span class="pn">Page 1194</span><strong>事件对象</strong>（event）的属性和方法：</li>
</ol>
<ul>
<li><em><strong>bubbles</strong></em>：表示事件是否冒泡；</li>
<li><em><strong>cancelable</strong></em>：表示是否可以取消事件的默认行为；</li>
<li><em><strong>currentTarget</strong></em>（this）：<strong>事件处理程序所在元素</strong>；</li>
<li><em><strong>defaultPrevented</strong></em>：表示是否阻止默认事件；</li>
<li><em><strong>detail</strong></em>：事件相关其他信息；</li>
<li><em><strong>eventPhase</strong></em>：表示调用事件处理程序的阶段；</li>
<li>（方法）<em><strong>preventDefault</strong></em>：取消事件的默认行为（cancelable 为 true 时可调用）；</li>
<li>（方法）<em><strong>stopImmediatePropagation</strong></em>：取消后续事件捕获冒泡，并阻止后续调用任何事件处理程序；</li>
<li>（方法）<em><strong>stopPropagation</strong></em>：取消所有后续事件的捕获或冒泡（bubbles 为 true 时可调用）；</li>
<li><em><strong>target</strong></em>（IE 中为 <em>srcElement</em>）：<strong>事件目标</strong>；</li>
<li><em><strong>trusted</strong></em>：事件是否由浏览器生成；</li>
<li><em><strong>type</strong></em>：<strong>事件类型</strong>；</li>
<li><em><strong>View</strong></em>：与事件相关的抽象视图。</li>
</ul>
<ol start="70">
<li><span class="pn">Page 1211</span><strong>事件类型</strong>：</li>
</ol>
<ul>
<li><strong>用户界面（UI）事件</strong>：涉及与 BOM 交互的通用浏览器事件；<ul>
<li><em><strong>load</strong></em>：windows 上当<strong>页面（所有外部资源）加载完毕后</strong>触发；&lt;img&gt; 元素上当<strong>图片加载完成后</strong>触发（<strong>当该元素对象具有 src 属性后，便会立即触发资源下载过程</strong>）；&lt;object&gt; 元素上当相应对象加载完成后触发；</li>
<li><em>unload</em>：windows 上当页面完全卸载后触发；&lt;object&gt; 元素上当相应对象被卸载后触发；</li>
<li><em>abort</em>：&lt;object&gt; 元素上当相应对象加载完成前被用户提前终止下载时触发；</li>
<li><em><strong>error</strong></em>：windows 上 <strong>JavaScript 报错时触发</strong>；&lt;img&gt; 元素上当<strong>图片无法加载时</strong>触发；&lt;object&gt; 元素上当相应对象无法加载后触发；</li>
<li><em><strong>select</strong></em>：在文本框中当用户选择了字符时触发；</li>
<li><em><strong>resize</strong></em>：windows 上当窗口被缩放时触发；</li>
<li><em><strong>scroll</strong></em>：当用户滚动包含滚动条的元素时，在元素上触发。</li>
</ul>
</li>
<li><strong>焦点事件</strong>：在元素获得和失去焦点时触发；<ul>
<li><em><strong>blur</strong></em>：元素失去焦点时触发，不冒泡；</li>
<li><em>focusout</em>：元素失去焦点时触发，冒泡：</li>
<li><em><strong>focus</strong></em>：元素获得焦点时触发，不冒泡；</li>
<li><em>focusin</em>：元素获得焦点时触发，冒泡；</li>
</ul>
</li>
<li><strong>鼠标事件</strong>：鼠标在页面上执行某些操作时触发；<ul>
<li><em><strong>click</strong></em>：鼠标左键或回车单击时触发；</li>
<li><em><strong>dblclick</strong></em>：鼠标左键双击时触发；</li>
<li><em><strong>mousedown</strong></em>：按下任意鼠标键时触发；</li>
<li><em>mouseenter</em>：鼠标光标从元素外部移动元素内部时触发；</li>
<li><em>mouseleave</em>：（与上相反）；</li>
<li><em>mousemove</em>：鼠标光标在元素上移动时反复触发；</li>
<li><em>mouseout</em>：鼠标光标从一个元素移到另一个元素时触发；</li>
<li><em>mouseover</em>：鼠标光标从元素外部移到元素内部时触发；</li>
<li><em>mouseup</em>：用户释放鼠标时触发。</li>
</ul>
</li>
<li><strong>滚轮事件</strong>：使用鼠标滚轮时触发；</li>
<li><strong>输入事件</strong>：向文档中输入文本时触发；</li>
<li><strong>键盘事件</strong>：键盘在页面上执行某些操作时触发；<ul>
<li><em><strong>keydown</strong></em>：用户按下键盘上某个键时触发，可持续触发；</li>
<li><em>keypress</em>：用户按下键盘上某个键并产生字符时触发，可持续触发；</li>
<li><em>keyup</em>：用户释放键盘上某个键时触发。</li>
</ul>
</li>
<li><strong>合成事件</strong>：使用某种 IME（Input Method Editor）输入字符时触发；</li>
<li><strong>HTML5 事件</strong>：补足 DOM 事件；<ul>
<li><em><strong>contextmenu</strong></em>：用户尝试打开上下文菜单（右键）时触发；</li>
<li><em><strong>beforeunload</strong></em>：浏览器窗口关闭或者刷新时触发；</li>
<li><em><strong>DOMContentLoaded</strong></em>：在 DOM 树构建完成后立即触发，不用等待图片、JavaScript 文件、CSS 文件等其他资源的完成；</li>
<li><em>readystatechange</em>：当文档的 readyState 属性发生改变时触发（触发时机不稳定）；</li>
<li><em>pageshow / pagehide</em>：页面显示/隐藏时触发；</li>
<li><em><strong>hashchange</strong></em>：URL 散列值发生变化时触发（可用于判断路由变化）；</li>
</ul>
</li>
<li><strong>自定义事件</strong>：<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/CustomEvent">CustomEvent</a>；</li>
</ul>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// add an appropriate event listener.</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'obj'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"cat"</span><span class="token punctuation">,</span> e <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>detail<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// create and dispatch the event.</span>
<span class="token keyword">let</span> event <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CustomEvent</span><span class="token punctuation">(</span><span class="token string">"cat"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  detail<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    hazcheeseburger<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><strong>其他事件</strong>：（参考 MDN）。</li>
</ul>
<ol start="71">
<li><span class="pn">Page 1296</span>事件优化：</li>
</ol>
<ul>
<li><strong>事件委托</strong>：利用“事件冒泡”，<strong>只在父节点（比如 document）使用一个事件处理程序</strong>来处理多个类别的事件；</li>
<li><strong>删除事件处理程序</strong>：<strong>在元素移除之前，删除其上的事件处理程序</strong>，防止可能的内存泄漏。</li>
</ul>
<br><div class="article-bottom-meta"><span class="post-meta">Last built on<time itemprop="dateModified" datetime="2020-12-18T15:24:24.000Z"> 2023 / 04 / 21, 10:01:05</time></span></div></div></article><br><span class="next-post"><a href="/2020/12/24/《JavaScript-高级程序设计（第四版）》读书笔记（第-18-28-章）/" itemprop="url">下一篇 ⇒</a></span><span class="prev-post"><a href="/2020/12/14/《JavaScript-高级程序设计（第四版）》读书笔记（第-8-11-章）/" itemprop="url">⇐ 上一篇</a></span><br><br><br><br><br></main><script src="/scripts/index.js" type="text/javascript"></script></body></html>